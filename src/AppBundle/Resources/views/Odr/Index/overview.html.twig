{% extends 'AppBundle:Layouts:application.html.twig' %}

{% set translationDomain = "odr-overview" %}
{% trans_default_domain translationDomain %}

{% block htmlTitle %}{{ 'page.htmlTitle' | trans }} {% endblock %}
{% block contentClass %}page-report-content report-overview odr-overview{% endblock %}

{% block pageContent %}
<div id="pagebody">
    <div id="pagebody-left-content">

        <h1 class="heading-xlarge">
            <span class="heading-secondary">{{ 'heading.title' | trans }}</span>
            {{ client.fullname }}
        </h1>

        {% if odrStatus.isReadyToSubmit %}
            <div id="header-report-submit" class="hero">
                <h2 class="heading">{{ 'odrReady' | trans }}</h2>
                <div class="message"><a class="button-grey submit-link behat-link-odr-submit" href="{{ path('odr_review') }}">{{ 'signAndSubmit' | trans() }}</a></div>
            </div>
        {% endif %}

        <div id="report-period-due">
            <div id="report-due" class="labelvalue">
                <div class="label">{{ 'dueDate' | trans() }}:</div>
                <div class="value">{{ odr.getDueDate() | date("j M Y") }}</div>
            </div>
        </div>

        {#
        http://hzaiwi.axshare.com/#g=1&p=odr_report_overview_-_not_started_-_first_time_use
        #}

        <ul id="overview-sections" class="overview-sections">

            <li id="visits-and-actions" class="overview-section">
                <h2 class="heading">Health and Welfare</h2>
                {% include 'AppBundle:Odr/Index:_subsection.html.twig' with {
                transDomain: translationDomain,
                subSection: 'visits_care',
                linkToSubSection: path('odr_visits_care', {odrId: odr.id}),
                odr: odr,
                info: true,
                description: true,
                state: odrStatus.visitsCareState,
                } %}
            </li>


            <li id="finances-and-assets" class="overview-section">
            <h2 class="heading">Property and finance</h2>
            {% include 'AppBundle:Odr/Index:_subsection.html.twig' with {
            transDomain: translationDomain,
            subSection: 'deputy_expenses',
            odr: odr,
            state: odrStatus.expensesState,
            nOfRecords: odr.expenses | length,
            linkToSubSection: path('odr_deputy_expenses', {odrId: odr.id}),
            description: true
            } %}
            {% include 'AppBundle:Odr/Index:_subsection.html.twig' with {
            transDomain: translationDomain,
            subSection: 'income_benefits',
            odr: odr,
            state: odrStatus.incomeBenefitsState,
            linkToSubSection: path('odr_income_benefits', {odrId: odr.id}),
            description: true
            } %}
            {% include 'AppBundle:Odr/Index:_subsection.html.twig' with {
            transDomain: translationDomain,
            subSection: 'bank_accounts',
            odr: odr,
            state: odrStatus.bankAccountsState,
            nOfRecords: odr.bankAccounts | length,
            linkToSubSection: path('odr_bank_accounts', {odrId: odr.id}),
            description: true
            } %}
            {% include 'AppBundle:Odr/Index:_subsection.html.twig' with {
            transDomain: translationDomain,
            subSection: 'assets',
            odr: odr,
            state: odrStatus.assetsState,
            nOfRecords: odr.assets | length,
            linkToSubSection: path('odr_assets', {odrId: odr.id}),
            description: true
            } %}
            {% include 'AppBundle:Odr/Index:_subsection.html.twig' with {
            transDomain: translationDomain,
            subSection: 'debts',
            odr: odr,
            description: false,
            state: odrStatus.getDebtsState,
            linkToSubSection: path('odr_debts', {odrId: odr.id}),
            description: true
            } %}
            {#{% include 'AppBundle:Odr/Index:_subsection.html.twig' with {#}
            {#transDomain: translationDomain,#}
            {#subSection: 'finances',#}
            {#odr: odr,#}
            {#description: false,#}
            {#state: odrStatus.getFinanceState,#}
            {#linkToSubSection: path('odr-expenses', {odrId: odr.id}),#}
            {#} %}#}
            </li>

            <li id="visits-and-actions" class="overview-section">
                <h2 class="heading">Other</h2>
                {% include 'AppBundle:Odr/Index:_subsection.html.twig' with {
                transDomain: translationDomain,
                subSection: 'actions',
                linkToSubSection: path('odr_actions', {odrId: odr.id}),
                odr: odr,
                info: true,
                description: true,
                state: odrStatus.actionsState,
                } %}
                {% include 'AppBundle:Odr/Index:_subsection.html.twig' with {
                transDomain: translationDomain,
                subSection: 'other_info',
                linkToSubSection: path('odr_other_info', {odrId: odr.id}),
                odr: odr,
                info: true,
                description: true,
                state: odrStatus.otherInfoState,
                } %}
            </li>

            <li id="report-submit-section" class="overview-section">
                <h2 class="heading">{{ 'heading.finishYourReport' | trans() }}</h2>
                {% set sectionParams = {
                transDomain: translationDomain,
                subSection: 'odr_add_further_info',
                odr: odr,
                linkToSubSection: path('odr_declaration'),
                description: false,
                state: odrStatus.isReadyToSubmit ? 'hidden' : 'not-started',
                editLinkClass: odrStatus.isReadyToSubmit ? 'button' : 'edit-link',
                } %}
                {% if odrStatus.isReadyToSubmit  %}
                    {% include 'AppBundle:Odr/Index:_subsection.html.twig' with sectionParams | merge({
                    editLinkClass: 'button',
                    }) %}
                {%  else %}
                    {% include 'AppBundle:Odr/Index:_subsection.html.twig' with sectionParams | merge({
                    disableedit: true ,
                    }) %}
                {%  endif %}
            </li>

        </ul>

        {% if not odrStatus.isReadyToSubmit  %}
        <div class="page-section-warning" id="cannot-submit-warning">
            <span class="icon icon__notification"></span>
            <p>{{ 'cantSubmitUntilComplete' | trans()  }}</p>
        </div>
        {% endif %}

        [<a href="{{ path('reset-odr', {'odrId': odr.id}) }}">Reset NDR data (only OTPP dev branch)</a>]

    </div>
    <div id="pagebody-right-content">
        {%include 'AppBundle:Components:_helpline.html.twig' %}
        {%include 'AppBundle:Odr/Index:_status.html.twig' with { odr: odr } %}
    </div>
</div>
{% endblock %}
